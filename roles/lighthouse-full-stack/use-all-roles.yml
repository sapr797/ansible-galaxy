---
- name: "ðŸŽ¯ Use All Available Roles"
  hosts: localhost
  connection: local
  
  tasks:
    - name: "ðŸ“‹ List available roles"
      debug:
        msg: "Found role: {{ item }}"
      loop: "{{ lookup('fileglob', 'roles/*/tasks/main.yml', wantlist=True) | map('dirname') | map('basename') | list }}"
      register: available_roles
    
    - name: "ðŸš€ Execute each role"
      include_role:
        name: "{{ item.item }}"
      loop: "{{ available_roles.results }}"
      when: item.item is defined
      
    - name: "âœ… All roles executed"
      debug:
        msg: "Successfully executed {{ available_roles.results | length }} roles"
