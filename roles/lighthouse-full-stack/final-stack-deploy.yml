---
- name: "ğŸ—ï¸ Deploy Complete Lighthouse Stack"
  hosts: localhost
  gather_facts: yes
  connection: local
  
  vars:
    stack_components:
      - database
      - web_server
      - application
      - monitoring
    
  pre_tasks:
    - name: "ğŸ” Pre-flight check"
      debug:
        msg: "Starting deployment of {{ stack_components | length }} components"
    
    - name: "ğŸ“¦ Update system packages"
      apt:
        update_cache: yes
        upgrade: safe
      when: ansible_os_family == "Debian"
  
  tasks:
    - name: "ğŸ—„ï¸ Deploy database (simulated)"
      debug:
        msg: "Database component deployed"
      tags: database
    
    - name: "ğŸŒ Deploy web server (simulated)"
      debug:
        msg: "Web server component deployed"
      tags: web
    
    - name: "ğŸš€ Deploy application (simulated)"
      debug:
        msg: "Application component deployed"
      tags: app
    
    - name: "ğŸ“Š Deploy monitoring (simulated)"
      debug:
        msg: "Monitoring component deployed"
      tags: monitoring
  
  post_tasks:
    - name: "âœ… Verify deployment"
      debug:
        msg: |
          ğŸ‰ STACK DEPLOYMENT COMPLETE!
          Time: {{ ansible_date_time.iso8601 }}
          Host: {{ ansible_hostname }}
          OS: {{ ansible_distribution }} {{ ansible_distribution_version }}
          
          Components deployed successfully:
          {% for component in stack_components %}
          - {{ component }}
          {% endfor %}
