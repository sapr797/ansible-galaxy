#!/bin/bash

set -e

echo "üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ansible-galaxy"
echo "=================================================="

cd ~/ansible-galaxy

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å git
echo "üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ git —Å—Ç–∞—Ç—É—Å–∞..."
git status

# –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
echo "üì¶ –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–π–ª—ã..."
git add .

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–∫–æ–º–º–∏—á–µ–Ω–æ
echo "üìã –§–∞–π–ª—ã –¥–ª—è –∫–æ–º–º–∏—Ç–∞:"
git status --short

# –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç
echo "üíæ –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç..."
git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è lighthouse-full-stack

–ù–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –≤ –ø–∞–ø–∫–µ '—Å—Ü–µ–Ω–∞—Ä–∏–∏/lighthouse-full-stack':
- –ü–æ–ª–Ω—ã–π —Å—Ç–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å —Ä–æ–ª—å—é-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (verify.yml)
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: PostgreSQL, Nginx, App, Lighthouse
- –ì–æ—Ç–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
‚úÖ –†–æ–ª—å-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º —Å—Ç–µ–∫–æ–º
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞"

# –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞ GitHub
echo "‚¨ÜÔ∏è  –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞ GitHub..."
git push origin main

if [ $? -eq 0 ]; then
    echo ""
    echo "üéâ –°–¶–ï–ù–ê–†–ò–ô –£–°–ü–ï–®–ù–û –ó–ê–ì–†–£–ñ–ï–ù!"
    echo "================================"
    echo "üìÅ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: —Å—Ü–µ–Ω–∞—Ä–∏–∏/lighthouse-full-stack/"
    echo "üåê –°—Å—ã–ª–∫–∞: https://github.com/sapr797/ansible-galaxy/tree/main/—Å—Ü–µ–Ω–∞—Ä–∏–∏/lighthouse-full-stack"
    echo ""
    echo "üìã –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ü–µ–Ω–∞—Ä–∏—è:"
    echo "  ‚Ä¢ verify.yml - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å—Ç–µ–∫–∞"
    echo "  ‚Ä¢ test-orchestrator-final-v2.yml - —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞"
    echo "  ‚Ä¢ simplest-orchestrator.yml - –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç"
    echo "  ‚Ä¢ roles/ - –≤—Å–µ —Ä–æ–ª–∏ Ansible"
    echo "  ‚Ä¢ scripts/ - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã"
    echo ""
    echo "üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:"
    echo "  git clone https://github.com/sapr797/ansible-galaxy.git"
    echo "  cd ansible-galaxy/—Å—Ü–µ–Ω–∞—Ä–∏–∏/lighthouse-full-stack"
    echo "  ansible-playbook verify.yml"
    echo "================================"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞ GitHub"
    exit 1
fi
