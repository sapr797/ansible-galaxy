---
- name: Debug message
  debug:
    msg: "Vector role is executing"

- name: Create test file
  copy:
    content: |
      Vector would be installed here
      For testing purposes, we just create this file
      Actual installation would use: apt install vector
    dest: /tmp/vector-test-installation.txt

- name: Create Vector config directory
  raw: mkdir -p /etc/vector && chmod 755 /etc/vector
  changed_when: false

- name: Create sample Vector config
  raw: |
    cat > /etc/vector/vector.yaml << 'CONFIG_EOF'
    # Sample Vector configuration
    sources:
      demo:
        type: "demo_logs"
        format: "json"
    
    sinks:
      stdout:
        type: "console"
        inputs: ["demo"]
        encoding:
          codec: "json"
    CONFIG_EOF
    chmod 644 /etc/vector/vector.yaml
  changed_when: false

# УБЕРИТЕ ЭТУ ЗАДАЧУ - она вызывает ошибку
# - name: Check Vector installation
#   command: which vector
#   register: vector_check
#   changed_when: false
#   ignore_errors: yes
